document.body.innerHTML+="<canvas id='canv' oncontextmenu='return false;'></canvas>";var link=document.createElement("link");link.href="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";link.rel="icon";link.type="image/x-icon";document.getElementsByTagName("head")[0].appendChild(link);document.body.style.setProperty("margin","0px");document.documentElement.style.setProperty("margin","0px");document.documentElement.style.setProperty("overflow","hidden");document.getElementById("canv").addEventListener("mousemove",mouseMove);document.getElementById("canv").addEventListener("mousedown",mouseDown);document.getElementById("canv").addEventListener("mouseup",mouseUp);document.getElementById("canv").addEventListener("mousewheel",mouseWheel);document.title="PS";let options={};options.width=0;options.height=0;options.cameraCenterX=0;options.cameraCenterY=0;options.isMouseDown=false;options.lastMouseX=0;options.lastMouseY=0;options.cameraZoom=1;options.fillColor="lightgray";options.millisecondsBetweenFrames=33;options.secondsBetweenFrames=1/options.millisecondsBetweenFrames;options.toWorldSpace=function(screenX,screenY){let x=screenX-(options.width/2-options.cameraCenterX);let y=screenY-(options.height/2-options.cameraCenterY);x/=options.cameraZoom;y/=options.cameraZoom;return[x,y]};options.toScreenSpace=function(worldX,worldY){let x=worldX*options.cameraZoom;let y=worldY*options.cameraZoom;x+=options.width/2-options.cameraCenterX;y+=options.height/2-options.cameraCenterY;return[x,y]};function initialBoot(){if(typeof firstUpdate==="function")firstUpdate(options);if(typeof options.tickOnce!=="undefined"&&options.tickOnce)console.log("Ticking only once.");else{setInterval(tick,options.millisecondsBetweenFrames)}}function tick(){var currentTime=new Date;var now=currentTime.getTime();update();drawCanvas()}function update(){canvas=document.getElementById("canv");options.width=window.innerWidth;options.height=window.innerHeight;canvas.width=options.width;canvas.height=options.height;if(typeof customUpdate==="function"){customUpdate(options)}drawCanvas()}function drawCanvas(){var ctx=canvas.getContext("2d");ctx.fillStyle=options.fillColor;ctx.fillRect(0,0,canvas.width,canvas.height);if(options.drawGrid){let ulx,uly;[ulx,uly]=options.toWorldSpace(0,0);let lrx,lry;[lrx,lry]=options.toWorldSpace(ctx.canvas.width,ctx.canvas.height);let startX,startY,stopX,stopY;let base=10;let min=Math.min(lrx-ulx,lry-uly);let step=Math.log10(min)/Math.log10(base);step=Math.floor(step);step=Math.pow(base,step);startX=parseInt((ulx-step)/step)*step;stopX=lrx;startY=parseInt((uly-step)/step)*step;stopY=lry;for(let x=startX;x<=stopX;x+=step){let tx,ty,t2;[tx,ty]=options.toScreenSpace(x,startY);[tx,t2]=options.toScreenSpace(x,stopY);ctx.strokeStyle="gray";if(x==0)ctx.strokeStyle="green";ctx.beginPath();ctx.moveTo(tx,ty);ctx.lineTo(tx,t2);ctx.stroke();ctx.fillStyle="white";ctx.fillText(x,tx+20,20)}for(let y=startY;y<=stopY;y+=step){let tx,ty,tx2;[tx,ty]=options.toScreenSpace(startX,y);[tx2,ty]=options.toScreenSpace(stopX,y);ctx.strokeStyle="gray";if(y==0)ctx.strokeStyle="red";ctx.beginPath();ctx.moveTo(tx,ty);ctx.lineTo(tx2,ty);ctx.stroke();ctx.fillStyle="white";ctx.fillText(-y,20,ty+20)}}ctx.save();ctx.translate(options.width/2-options.cameraCenterX,options.height/2-options.cameraCenterY);ctx.scale(options.cameraZoom,-options.cameraZoom);if(typeof customDraw==="function"){customDraw(ctx,options)}ctx.restore();if(typeof customUI==="function"){customUI(ctx,options)}}function mouseMove(e){if(noEvents())return;let currentMouseX=e.clientX;let currentMouseY=e.clientY;if(options.isMouseDown){let diffX=currentMouseX-options.lastMouseX;let diffY=currentMouseY-options.lastMouseY;options.cameraCenterX-=diffX;options.cameraCenterY-=diffY}options.lastMouseX=e.clientX;options.lastMouseY=e.clientY}function mouseDown(e){if(noEvents())return;let currentMouseX=e.clientX;let currentMouseY=e.clientY;options.lastMouseX=e.clientX;options.lastMouseY=e.clientY;options.isMouseDown=true}function mouseUp(e){if(noEvents())return;let currentMouseX=e.clientX;let currentMouseY=e.clientY;options.lastMouseX=e.clientX;options.lastMouseY=e.clientY;options.isMouseDown=false}function mouseWheel(e){if(noEvents())return;let x=e.clientX-(options.width/2-options.cameraCenterX);let y=e.clientY-(options.height/2-options.cameraCenterY);x/=options.cameraZoom;y/=options.cameraZoom;if(e.wheelDelta>0){options.cameraZoom*=1.1}else if(e.wheelDelta<0){options.cameraZoom/=1.1}if(options.cameraZoom>10){options.cameraZoom=10}if(options.cameraZoom<.1){options.cameraZoom=.1}let x2=e.clientX-(options.width/2-options.cameraCenterX);let y2=e.clientY-(options.height/2-options.cameraCenterY);x2/=options.cameraZoom;y2/=options.cameraZoom;options.cameraCenterX-=x2-x;options.cameraCenterY-=y2-y}function noEvents(){return typeof options.ignoreEvents!=="undefined"&&options.ignoreEvents}initialBoot();
